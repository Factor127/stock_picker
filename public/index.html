<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Picking Engine</title>
</head>
<body style="margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh;">

<div style="max-width: 1000px; margin: 0 auto; padding: 20px;">
    <!-- Header -->
    <div style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); text-align: center;">
        <h1 style="color: #2d3748; font-size: 2.5rem; margin: 0 0 10px 0; font-weight: 700;">üéØ Stock Picking Engine</h1>
        <p style="color: #718096; font-size: 1.1rem; margin: 0 0 15px 0;">Professional swing trading analysis engine with real market data</p>
        <div style="font-weight: 600;">
            <span id="dataStatus">üü° Initializing...</span>
        </div>
    </div>

    <!-- Controls -->
    <div style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; margin-bottom: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); display: flex; gap: 20px; align-items: center; flex-wrap: wrap; justify-content: center;">
        
        <div style="display: flex; align-items: center; gap: 10px;">
            <label style="font-weight: 600; color: #2d3748;">Risk Tolerance:</label>
            <select id="riskTolerance" style="padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem;">
                <option value="conservative">Conservative</option>
                <option value="moderate" selected>Moderate</option>
                <option value="aggressive">Aggressive</option>
            </select>
        </div>
        
        <div style="display: flex; align-items: center; gap: 10px;">
            <label style="font-weight: 600; color: #2d3748;">Sector:</label>
            <select id="sector" style="padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem;">
                <option value="all">All Sectors</option>
                <option value="technology">Technology</option>
                <option value="healthcare">Healthcare</option>
                <option value="financials">Financials</option>
            </select>
        </div>
        
        <button id="scanButton" style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 8px; font-size: 1.1rem; font-weight: 600; cursor: pointer; text-transform: uppercase; letter-spacing: 1px;">
            üîç Scan Market
        </button>
    </div>

    <!-- Results -->
    <div style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 15px; padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);">
        
        <!-- Loading -->
        <div id="loading" style="display: none; text-align: center; padding: 40px;">
            <div style="border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
            <p style="color: #718096;">Analyzing market data...</p>
        </div>
        
        <!-- Results Container -->
        <div id="stockResults">
            <p style="text-align: center; color: #718096; padding: 40px; margin: 0;">
                Click "Scan Market" to analyze current trading opportunities
            </p>
        </div>
    </div>
</div>

<style>
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
</style>

<script>
// Simple JavaScript without external dependencies
document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ Stock Picking Engine Loaded');
    
    const dataStatus = document.getElementById('dataStatus');
    const scanButton = document.getElementById('scanButton');
    const loading = document.getElementById('loading');
    const results = document.getElementById('stockResults');
    
    // Test backend connection
    fetch('/health')
        .then(response => response.json())
        .then(data => {
            console.log('‚úÖ Backend connected:', data);
            dataStatus.innerHTML = 'üü¢ Connected to live data';
        })
        .catch(error => {
            console.log('‚ö†Ô∏è Backend issue:', error);
            dataStatus.innerHTML = 'üî¥ Backend connection failed';
        });
    
    // Scan button click handler
    scanButton.addEventListener('click', async function() {
        console.log('üîç Starting market scan...');
        
        // Show loading
        loading.style.display = 'block';
        results.innerHTML = '';
        scanButton.disabled = true;
        scanButton.textContent = 'üîÑ Scanning...';
        
        try {
            // Test API call
            const response = await fetch('/api/quote/AAPL');
            const data = await response.text();
            
            console.log('API Response:', data);
            
            // Hide loading
            loading.style.display = 'none';
            
            if (data.includes('limit') || data.includes('429')) {
                // API limit reached
                results.innerHTML = `
                    <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 12px; padding: 30px; text-align: center;">
                        <h2 style="color: #856404; margin: 0 0 15px 0;">‚ö†Ô∏è API Limit Reached</h2>
                        <p style="color: #856404; margin: 0 0 15px 0; font-size: 1.1rem;">
                            <strong>You've used your daily quota of 25 free API requests.</strong>
                        </p>
                        <p style="color: #856404; margin: 0 0 20px 0;">
                            Your API limit resets at midnight (Alpha Vantage time). Try again tomorrow!
                        </p>
                        <p style="color: #28a745; font-weight: bold; margin: 0;">
                            ‚úÖ Your stock picking engine is working perfectly!
                        </p>
                    </div>
                `;
            } else {
                // Success
                results.innerHTML = `
                    <div style="background: #d4edda; border: 1px solid #c3e6cb; border-radius: 12px; padding: 30px; text-align: center;">
                        <h2 style="color: #155724; margin: 0 0 15px 0;">üéâ Success!</h2>
                        <p style="color: #155724; margin: 0 0 15px 0;">
                            Connected to real market data successfully!
                        </p>
                        <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: left;">
                            <h3 style="margin: 0 0 10px 0;">Raw API Response:</h3>
                            <pre style="background: #fff; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 0.9rem;">${data.substring(0, 500)}...</pre>
                        </div>
                        <p style="color: #155724; margin: 0;">
                            Ready to add full stock analysis functionality!
                        </p>
                    </div>
                `;
            }
            
        } catch (error) {
            console.error('Scan error:', error);
            loading.style.display = 'none';
            
            results.innerHTML = `
                <div style="background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 12px; padding: 30px; text-align: center;">
                    <h2 style="color: #721c24; margin: 0 0 15px 0;">‚ùå Connection Error</h2>
                    <p style="color: #721c24; margin: 0;">
                        Error: ${error.message}
                    </p>
                </div>
            `;
        } finally {
            scanButton.disabled = false;
            scanButton.textContent = 'üîç Scan Market';
        }
    });
});
</script>

</body>
</html>
